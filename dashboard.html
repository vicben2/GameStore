<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Game Store Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background-color: var(--bg, #121212);
      color: var(--text, #fff);
      transition: all 0.3s ease;
    }
    header {
      background-color: #1e1e2f;
      padding: 20px 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.6);
    }
    header h1 { font-size: 2em; color: #4ecdc4; }
    header .user-info {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    header .user-info span { font-weight: 300; }
    header .user-buttons button {
      background-color: #555;
      border: none;
      color: white;
      padding: 6px 12px;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
      transition: 0.3s ease;
    }
    header .user-buttons button:hover {
      background-color: #777;
    }

    nav {
      display: flex;
      justify-content: center;
      background: #181828;
      gap: 30px;
      padding: 15px;
    }
    nav button {
      background: none;
      color: white;
      border: none;
      font-size: 1em;
      padding: 10px 20px;
      border-radius: 10px;
      transition: all 0.3s ease;
      cursor: pointer;
    }
    nav button.active, nav button:hover {
      background-color: #ff6b6b;
      color: #fff;
    }

    .container { padding: 30px 40px; }

    .section { display: none; }
    .section.active {
      display: block;
      animation: fadeIn 0.3s ease-in-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .logout-btn {
      background-color: #e74c3c;
    }

    .theme-toggle {
      background-color: #555;
      border-radius: 8px;
      padding: 8px 12px;
      color: white;
      cursor: pointer;
      font-weight: bold;
    }

    .game-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 20px;
    }

    .game-card {
      background: #2a2a3a;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4);
      transition: transform 0.3s ease;
    }

    .game-card:hover {
      transform: scale(1.03);
      background: #33334a;
    }

    .game-card img {
      width: 100%;
      border-radius: 12px;
      margin-bottom: 15px;
    }

    .game-card h3 { margin: 0; font-size: 1.3em; font-weight: 600; }
    .price-tag { color: #f1c40f; font-weight: 600; margin-top: 5px; }

    .buy-btn {
      margin-top: 15px;
      background-color: #27ae60;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      transition: background 0.3s ease;
    }

    .buy-btn:hover { background-color: #2ecc71; }

    #searchInput {
      padding: 12px 15px;
      width: 100%;
      max-width: 400px;
      border-radius: 10px;
      border: none;
      margin-bottom: 30px;
      font-size: 1em;
    }

    .cart {
      margin-top: 40px;
      background: #1f1f2f;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }

    ul#cartItems {
      list-style: none;
      padding: 0;
    }

    ul#cartItems li {
      padding: 5px 0;
      border-bottom: 1px solid #444;
      display: flex;
      justify-content: space-between;
    }

    .remove-btn {
      background-color: #e74c3c;
      color: white;
      border: none;
      padding: 4px 10px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.85em;
      transition: background 0.3s ease;
    }

    .remove-btn:hover {
      background-color: #c0392b;
    }

    .library-nav {
      display: flex;
      gap: 15px;
      margin: 20px 0;
    }

    .library-nav button {
      background-color: #2a2a3a;
      color: #fff;
      padding: 10px 15px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.3s;
    }

    .library-nav button.active, .library-nav button:hover {
      background-color: #3498db;
    }

    .lib-section { display: none; }
    .lib-section.active {
      display: block;
      animation: fadeIn 0.3s ease-in-out;
    }

    #libraryList, #downloadedList {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 15px;
    }

    .library-item {
      background: #2a2a3a;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .library-item img {
      width: 100px;
      height: 60px;
      border-radius: 8px;
      object-fit: cover;
    }

    .library-item-details { flex-grow: 1; }
    .library-item-details h4 {
      margin-top: 0;
      margin-bottom: 5px;
      font-weight: bold;
    }

    .library-item-details p {
      margin-bottom: 0;
      font-size: 0.9em;
      color: #ccc;
    }

    .download-btn {
      background-color: #2980b9;
      color: white;
      border: none;
      padding: 6px 10px;
      border-radius: 6px;
      font-size: 0.9em;
      cursor: pointer;
    }

    .download-btn:hover {
      background-color: #3498db;
    }

    /* Button for removing from collection */
    .remove-collection-btn {
      background-color: #e74c3c;
      color: white;
      border: none;
      padding: 4px 10px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.85em;
      transition: background 0.3s ease;
      margin-top: 5px;
    }
    .remove-collection-btn:hover {
      background-color: #c0392b;
    }

    .community-content {
      font-size: 1.1em;
      line-height: 1.6em;
      padding: 15px;
    }
  </style>
</head>
<body>

  <header>
    <h1>Game Store</h1>
    <div class="user-info">
      <span>Welcome, <strong id="username">Player</strong></span>
      <div class="user-buttons">
        <a href="profile.html">
          <button>View Profile</button>
        </a>
        <button class="logout-btn" onclick="logout()">Logout</button>
        <button class="theme-toggle" onclick="toggleTheme()">Toggle Theme</button>
      </div>
    </div>
  </header>

  <nav>
    <button class="tab-button active" data-tab="store">Store</button>
    <button class="tab-button" data-tab="library">Library</button>
    <button class="tab-button" data-tab="community">Community</button>
  </nav>

  <div class="container">
    <div class="section active" id="store">
      <input type="text" id="searchInput" placeholder="Search games or genre...">
      <div class="game-list" id="gameList"></div>
      <div class="cart">
        <h3>Your Cart</h3>
        <ul id="cartItems"></ul>
        <p>Total: $<span id="cartTotal">0.00</span></p>
        <button class="buy-btn" onclick="checkout()">Checkout</button>
      </div>
    </div>

    <div class="section" id="library">
      <h2>Your Library</h2>
      <div class="library-nav">
        <button class="lib-tab-button active" data-lib-tab="lib-home">Home</button>
        <button class="lib-tab-button" data-lib-tab="lib-collection">Collection</button>
        <button class="lib-tab-button" data-lib-tab="lib-downloads">Downloaded</button>
      </div>
      <div id="lib-home" class="lib-section active">
        <p>Welcome to your game library! View your collection or manage downloads.</p>
      </div>
      
      <div id="lib-collection" class="lib-section">
        <h3>Your Purchased Games</h3>
        <div id="libraryList"></div>
      </div>
      <div id="lib-downloads" class="lib-section">
        <h3>Downloaded Games</h3>
        <div id="downloadedList"></div>
      </div>
    </div>
    

    <div class="section" id="community">
      <h2>Community</h2>
      <div class="community-content">
        <p>Welcome to the GameZone Community! Chat, share tips, and team up with other players.</p>
        <p>🌟 Forums coming soon!</p>
      </div>
    </div>

    <div class="section" id="profile" style="display:none;">
      <h2>Your Profile</h2>
      <p>This is a placeholder for your profile page.</p>
    </div>
  </div>

  <script>
    const username = sessionStorage.getItem("username") || "Guest";
    document.getElementById("username").textContent = username;
    const isLoggedIn = username !== "Guest";

    const games = [
      { title: "Dragon Quest", genre: "RPG", price: 29.99, img: "https://via.placeholder.com/250x140?text=Dragon+Quest" },
      { title: "Call of Warfare", genre: "Shooter", price: 49.99, img: "https://via.placeholder.com/250x140?text=Call+of+Warfare" },
      { title: "Sky Builder", genre: "Simulation", price: 19.99, img: "https://via.placeholder.com/250x140?text=Sky+Builder" },
      { title: "Fast Racers", genre: "Racing", price: 24.99, img: "https://via.placeholder.com/250x140?text=Fast+Racers" },
      { title: "Fantasy Tactics", genre: "Strategy", price: 39.99, img: "https://via.placeholder.com/250x140?text=Fantasy+Tactics" },
      { title: "Zombie Slayer", genre: "Action", price: 19.99, img: "https://via.placeholder.com/250x140?text=Zombie+Slayer" },
      { title: "Cyber Legends", genre: "Sci-Fi", price: 39.99, img: "https://via.placeholder.com/250x140?text=Cyber+Legends" },
      { title: "Pirate's Treasure", genre: "Adventure", price: 29.99, img: "https://via.placeholder.com/250x140?text=Pirate's+Treasure" }
    ];

    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    let purchased = JSON.parse(localStorage.getItem("purchased")) || [];
    let downloaded = JSON.parse(localStorage.getItem("downloaded")) || [];

    function displayGames(filteredGames = games) {
      const gameList = document.getElementById("gameList");
      gameList.innerHTML = "";
      filteredGames.forEach((game, i) => {
        const div = document.createElement("div");
        div.className = "game-card";
        div.innerHTML = `
          <img src="${game.img}" alt="${game.title}">
          <h3>${game.title}</h3>
          <p>Genre: ${game.genre}</p>
          <div class="price-tag">$${game.price.toFixed(2)}</div>
          <button class="buy-btn" onclick="addToCart(${i})">Add to Cart</button>
        `;
        gameList.appendChild(div);
      });
    }

    function addToCart(index) {
      if (!isLoggedIn) return window.location.href = "login.html";
      cart.push(games[index]);
      localStorage.setItem("cart", JSON.stringify(cart));
      updateCart();
    }

    function removeFromCart(index) {
      cart.splice(index, 1);
      localStorage.setItem("cart", JSON.stringify(cart));
      updateCart();
    }

    function updateCart() {
      const cartItems = document.getElementById("cartItems");
      const cartTotal = document.getElementById("cartTotal");
      cartItems.innerHTML = "";
      let total = 0;
      cart.forEach((game, i) => {
        const li = document.createElement("li");
        li.innerHTML = `
          ${game.title} - $${game.price.toFixed(2)}
          <button class="remove-btn" onclick="removeFromCart(${i})">Remove</button>
        `;
        cartItems.appendChild(li);
        total += game.price;
      });
      cartTotal.textContent = total.toFixed(2);
    }

    function checkout() {
      cart.forEach(game => {
        if (!purchased.find(g => g.title === game.title)) {
          purchased.push({ title: game.title, img: game.img });
          downloaded.push({ title: game.title, img: game.img });
        }
      });
      cart = [];
      localStorage.setItem("purchased", JSON.stringify(purchased));
      localStorage.setItem("downloaded", JSON.stringify(downloaded));
      localStorage.setItem("cart", JSON.stringify(cart));
      updateCart();
      updateLibrary();
      alert("✅ Thank you for your purchase!");
    }

    function updateLibrary() {
      const libraryList = document.getElementById("libraryList");
      const downloadedList = document.getElementById("downloadedList");
      libraryList.innerHTML = "";
      downloadedList.innerHTML = "";

      purchased.forEach(game => {
        const div = document.createElement("div");
        div.className = "library-item";
        div.innerHTML = `
          <img src="${game.img}" alt="${game.title}">
          <div class="library-item-details">
            <h4>${game.title}</h4>
            <p>Purchased</p>
            <button class="download-btn" onclick="download('${game.title}')">Download</button>
            <button class="remove-collection-btn" onclick="removeFromCollection('${game.title}')">Remove</button>
          </div>
        `;
        libraryList.appendChild(div);
      });

      downloaded.forEach(game => {
        const div = document.createElement("div");
        div.className = "library-item";
        div.innerHTML = `
          <img src="${game.img}" alt="${game.title}">
          <div class="library-item-details">
            <h4>${game.title}</h4>
            <p>Downloaded</p>
          </div>
        `;
        downloadedList.appendChild(div);
      });
    }

    function removeFromCollection(title) {
      // Remove game from purchased list by filtering
      purchased = purchased.filter(game => game.title !== title);
      localStorage.setItem("purchased", JSON.stringify(purchased));
      updateLibrary();
    }

    function download(title) {
      alert(`⬇️ Downloading ${title}...`);
    }

    function toggleTheme() {
      const root = document.documentElement.style;
      const dark = getComputedStyle(document.body).backgroundColor === 'rgb(18, 18, 18)';
      if (dark) {
        root.setProperty('--bg', '#f4f4f4');
        root.setProperty('--text', '#000');
      } else {
        root.setProperty('--bg', '#121212');
        root.setProperty('--text', '#fff');
      }
    }

    function logout() {
      sessionStorage.clear();
      window.location.href = "login.html";
    }

    document.querySelectorAll(".tab-button").forEach(btn => {
      btn.addEventListener("click", () => {
        const tab = btn.dataset.tab;
        document.querySelectorAll(".section").forEach(s => s.classList.remove("active"));
        document.getElementById(tab).classList.add("active");
        document.getElementById("profile").style.display = "none";
        document.querySelectorAll(".tab-button").forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
      });
    });

    document.querySelectorAll(".lib-tab-button").forEach(btn => {
      btn.addEventListener("click", () => {
        const tab = btn.dataset.libTab;
        document.querySelectorAll(".lib-section").forEach(sec => sec.classList.remove("active"));
        document.getElementById(tab).classList.add("active");
        document.querySelectorAll(".lib-tab-button").forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
      });
    });

    document.getElementById("searchInput").addEventListener("input", function () {
      const search = this.value.toLowerCase();
      const filtered = games.filter(game =>
        game.title.toLowerCase().includes(search) || game.genre.toLowerCase().includes(search)
      );
      displayGames(filtered);
    });

    window.onload = () => {
      displayGames();
      updateCart();
      updateLibrary();
    };
  </script>
</body>
</html>
